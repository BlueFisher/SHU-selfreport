# ä¸Šæµ·å¤§å­¦å¥åº·ä¹‹è·¯æ¯æ—¥ä¸€æŠ¥è‡ªåŠ¨æ‰“å¡

***ï¼ï¼ï¼æœ¬é¡¹ç›®ä¸æ”¯æŒè¿›è¡Œè™šå‡å¡«æŠ¥ï¼ï¼ï¼ä»…æ ¹æ®å‰ä¸€å¤©å¡«æŠ¥å†…å®¹è‡ªåŠ¨å¡«æŠ¥ï¼Œä»¥å…é—å¿˜æ¼æŠ¥***

ç¨‹åºä¸ºpythonè„šæœ¬æ–‡ä»¶ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ç›¸å…³ä¿¡æ¯ï¼Œè®¾ç½®åå°è¿è¡Œè„šæœ¬ï¼Œè„šæœ¬ä¼šæ ¹æ®é…ç½®æ–‡ä»¶ä¿¡æ¯è‡ªåŠ¨è¿›è¡Œæ¯æ—¥ä¸€æŠ¥ã€‚

æ”¯æŒgithub actionsæœåŠ¡å™¨ã€‚

æ”¯æŒä¸€é”®è¡¥æŠ¥åŠŸèƒ½ã€‚

æ”¯æŒæ¯æ—¥ä¸€æŠ¥ã€‚ç›®å‰åœ¨ 4:00AM(report_remote)/3:00AM(report) è‡ªåŠ¨å¡«æŠ¥ä¸€æ¬¡ã€‚

ä¸ºäº†é¿å…è¿‡å¤šçš„é…ç½®ï¼Œæ„Ÿè°¢[@Lanszhang131](https://github.com/Lanszhang131/DailyReport_SHU)çš„æ€è·¯ï¼Œ**åˆ©ç”¨å‰ä¸€å¤©çš„æŠ¥é€ä¿¡æ¯è¿›è¡Œå¡«æŠ¥ï¼Œæ‰€ä»¥å¦‚æœä½ çœŸå®åœ°æäº¤è¿‡ä¸€æ¬¡ï¼Œé‚£æ¯å¤©ä¼šé‡å¤å¡«æŠ¥ã€‚ç”±äºé»˜è®¤æ˜¯ 4:00AM(report_remote)/3:00AM(report) å¡«æŠ¥ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ç”¨çœŸå®ä¿¡æ¯çš„è¯ç¬¬ä¸€æ¬¡åœ¨æ—©ä¸Š6ç‚¹å¡«æŠ¥åä¿®æ”¹ä¸‹ä¿¡æ¯ã€‚**


## æ›´æ–°æ—¥å¿—

**ç”±äºOpenVPNåŒä¸€æ—¶é—´ç™»å½•ç™»é™†äººæ•°è¿‡å¤šï¼Œç°éšæœºç­‰å¾…600-1440ç§’å†è¿æ¥**

**æ–°å¢ Auto Report from Remoteï¼Œå¯ä»¥æ‹‰å–è¿œç¨‹æœ€æ–°çš„ä»£ç ï¼Œä¸å†éœ€è¦æ¯æ¬¡æ›´æ–°ï¼Œæ¯æ¬¡æ‹‰å–**

**é€‚é…2022-03-22ç‰ˆæœ¬ï¼Œä¿®æ”¹å­—æ®µï¼ˆæ—©æ—¥è§£å°ï¼‰**

**é€‚é…2022-03-20ç‰ˆæœ¬ï¼Œå¢åŠ æ ¡åŒºï¼ˆæ—©æ—¥è§£å°ï¼‰**

**é€‚é…2022-02-28ç‰ˆæœ¬ï¼ŒGitHub Actions æ–°å¢è¿æ¥å­¦æ ¡VPNå†å¡«æŠ¥åŠŸèƒ½**

~~ä½¿ç”¨seleniumæäº¤è¡¨å•ï¼ˆæµ‹è¯•ä¸­ï¼‰ï¼Œè‡ªåŠ¨ç”Ÿæˆè¡Œç¨‹ç ï¼ˆç›®å‰å‘ç°è¡Œç¨‹ç åªéœ€è¦å›¾ç‰‡ä¸­æœ‰æ—¥æœŸæ–‡å­—ï¼Œä¸”å›¾ç‰‡é•¿å®½æ¯”ä¸æ‰‹æœºå·®ä¸å¤šå°±è¡Œï¼‰~~

~~é€‚é…2022-01-15ç‰ˆï¼Œå¢åŠ éšç”³ç ã€‚è¯·çœŸå®æäº¤éšç”³ç ä¸è¡Œç¨‹ç ã€‚ä¸ä¿¡è°£ä¸ä¼ è°£ï¼~~

**é€‚é…2021-11-05ç‰ˆï¼ŒDangSZS**

**é€‚é…2021-11-04ç‰ˆï¼Œä¿®å¤äº†ShiFSHå­—æ®µ [issue 51](https://github.com/BlueFisher/SHU-selfreport/issues/51)ï¼Œå»é™¤éšç”³ç ï¼Œä¸°å¯Œæ—¥å¿—è®°å½•ï¼Œè‹¥å‡ºç°é”™è¯¯ï¼Œå¯ä»¥å½“å¤©çœŸå®æäº¤ä¸€æ¬¡ï¼Œç­‰ç¬¬äºŒå¤©å†è§‚å¯Ÿ**

**é€‚é…2021-10-08ç‰ˆï¼Œè·å–å½“å¤©çš„éšç”³ç ã€è¡Œç¨‹ç ã€‚è¯·çœŸå®åœ°æäº¤ä¸€æ¬¡éšç”³ç ã€è¡Œç¨‹ç ï¼Œåç»­ä¼šè‡ªåŠ¨é‡‡ç”¨ä¹‹å‰ä¸Šä¼ çš„éšç”³ç ã€è¡Œç¨‹ç **

**é€‚é…2021-06-28ç‰ˆï¼Œæ›´æ–°github actionçš„è‡ªåŠ¨æ‰“å¡æ—¶é—´**

**é€‚é…2021-04-24ç‰ˆï¼Œæš‚ä¸æ”¯æŒå…šå²çŸ¥è¯†å¤©å¤©å­¦**


## å…è´£ç”³æ˜

æœ¬é¡¹ç›®ä»…åšå…è´¹çš„å­¦æœ¯äº¤æµä½¿ç”¨ã€‚

## ç”¨æ³•

### 0. â­Starâ­é¡¹ç›®ğŸ˜‰

å¦‚æœä½ æƒ³è·å–æœ€æ–°çš„æ›´æ–°ï¼Œè®°å¾—å³ä¸Šè§’çš„`watch`


### 1. å¦‚æœä½ æ²¡æœ‰æœåŠ¡å™¨ï¼Œä½¿ç”¨ github actionsï¼ˆæ¨èï¼‰

#### ä½ ç¬¬ä¸€æ¬¡Fork

1. fork è¯¥ä»“åº“è‡³ä½ çš„ä»“åº“ä¸‹
2. å®šä½åˆ°ä½ çš„ä»“åº“çš„`Settings`çš„`Secrets`é€‰é¡¹å¡
3. æ·»åŠ secretï¼ˆNew repository secretï¼‰

`NAME` è®¾ç½®ä¸º `USERS`

`VALUE` è®¾ç½®ä¸º `å­¦å·1,å¯†ç 1;å­¦å·2,å¯†ç 2` çš„æ ¼å¼ï¼Œæ³¨æ„é€—å·ä¸åˆ†å·çš„åŒºåˆ†ï¼Œå­¦å·å¯†ç ä¹‹é—´ç”¨é€—å·ï¼Œæ¯ä¸¤ä¸ªå­¦å·ä¹‹é—´ç”¨åˆ†å·ï¼Œå¿…é¡»æ˜¯è‹±æ–‡åŠè§’ç¬¦å·ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªå­¦å·å¯†ç åˆ™ä¸éœ€è¦åŠ åˆ†å·

![](images/secrets.png)

4. å®šä½åˆ°ä½ ä»“åº“ä¸‹çš„ `Actions` é€‰é¡¹å¡ä¸­çš„ `Auto Report from Remote`ï¼Œç‚¹å‡» `Enable workflow`ï¼Œæ­¤æ—¶æ¯å¤©ä¼šè‡ªåŠ¨æ‹‰å–ä¸»ä»“åº“ä»£ç ï¼Œè‡ªåŠ¨å¡«æŠ¥ï¼Œç†è®ºä¸Šä¸å†éœ€è¦æ›´æ–°ã€‚

![](images/enable_workflow.png)

5. å®šä½åˆ°ä½ ä»“åº“ä¸‹çš„ `Actions` é€‰é¡¹å¡ä¸­çš„ `Auto Report`ï¼Œç‚¹å‡» `Disable workflow`ï¼Œè¯¥é€‰é¡¹å¡ä¼šæ ¹æ®ä½ è‡ªå·±forkçš„ä»£ç è‡ªåŠ¨å¡«æŠ¥ï¼Œå¦‚æœä¸»ä»“åº“æ›´æ–°ï¼Œåˆ™æ— æ³•åŠæ—¶ä½¿ç”¨æ–°ä»£ç ã€‚

![](images/disable_workflow.png)

***ç”±äº `Auto Report from Remote` ä¸ `Auto Report` éƒ½ä¼šç™»å½• OpenVpn å¯¼è‡´å†²çªï¼Œæ‰€ä»¥åŒä¸€æ—¶é—´åªèƒ½å¯åŠ¨ä¸€ä¸ª workflowï¼Œå»ºè®®å–æ¶ˆ `Auto Report`ï¼Œå¼€å¯ `Auto Report from Remote`ã€‚***

6. æ­¤æ—¶ Actions å·²ç»å¯åŠ¨å®Œæˆï¼Œæ¯æ‰§è¡Œä¸€æ¬¡ä¼šåœ¨ `Actions` é€‰é¡¹å¡ä¸‹ç”Ÿæˆä¸€ä¸ªæŠ¥å‘Šã€‚

   å¦‚æœéœ€è¦å¯¹æŠ¥é€åŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œå¯ä»¥ç‚¹å‡» `Run workflow` æŒ‰é’®ï¼Œç«‹å³è¿›è¡Œä¸€æ¬¡è¿è¡Œã€‚

   ![](images/run_workflow.png)

![](images/actions.png)


#### ä½ ç¬¬äºŒæ¬¡Forkï¼Œè¦æ›´æ–°åŸå…ˆå†…å®¹

1. ç‚¹å‡» `Fetch upstream`

![](images/fetch_upstream_01.png)

2. ç‚¹å‡» `Fetch and merge`

![](images/fetch_upstream_02.png)


### 2. å¦‚æœä½ æœ‰æœåŠ¡å™¨ï¼Œåªåœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šè¿›è¡Œè‡ªåŠ¨æ‰“å¡

åœ¨ `config.yaml` ä¸­è®¾ç½®æ‰€æœ‰éœ€è¦æ‰“å¡çš„å­¦å·å¯†ç 

é’ˆå¯¹Ubuntuï¼Œç¼–è¾‘å®šæ—¶æ‰§è¡Œç¨‹åºcron

```bash
crontab -e
```

åŠ å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# ç¨‹åºæ¯å¤©4ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶å°†ç»“æœè¾“å‡ºè‡³shu_report.log
# æ³¨æ„pythonçš„è·¯å¾„ï¼Œmain.pyä¸è¾“å‡ºæ—¥å¿—shu_report.logçš„ç»å¯¹è·¯å¾„
0 4 * * * python -u /xxx/main.py 2>&1 >> /xxx/shu_report.log
```

å¦‚æœä½ æœåŠ¡å™¨æ˜¯UTCæ—¶åŒºï¼Œåˆ™ä¸º

```bash
0 20 * * * python -u /xxx/main.py 2>&1 >> /xxx/shu_report.log
```

å¦‚æœä½ ä¸ç¡®å®šä½ æœåŠ¡å™¨çš„æ—¶åŒºï¼Œä¹Ÿå¯ä»¥æ¯å°æ—¶è¿è¡Œä¸€æ¬¡ï¼š

```bash
0 * * * * python -u /xxx/main.py 2>&1 >> /xxx/shu_report.log
```

## ä¾èµ–

- python3
- ä¾èµ–ï¼š
  - pyyaml
  - beautifulsoup4
  - requests
  - pillow

## æ„Ÿè°¢

æ„Ÿè°¢å„ä½ contributors æ‰€åšçš„è´¡çŒ®ã€‚

